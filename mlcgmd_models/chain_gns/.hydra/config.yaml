data:
  name: chain
  dir: ${oc.env:CHAIN_DATASET_DIR}
  dimension: 3
  batch_size: 32
  traj_len: 10000
  recursive_metis: false
  datamodule:
    _target_: graphwm.data.datamodule.PLDataModule
    datasets:
      train:
        _target_: graphwm.data.PolymerDataset
        split: ${oc.env:PROJECT_ROOT}/splits/chain/train.txt
        directory: ${data.dir}
        dilation: ${model.dilation}
        seq_len: ${model.seq_len}
        grouping: ${model.cg_level}
        traj_len: ${data.traj_len}
        recursive_metis: ${data.recursive_metis}
      val:
      - _target_: graphwm.data.PolymerDataset
        split: ${oc.env:PROJECT_ROOT}/splits/chain/val.txt
        directory: ${data.dir}
        dilation: ${model.dilation}
        seq_len: ${model.seq_len}
        grouping: ${model.cg_level}
        traj_len: ${data.traj_len}
        recursive_metis: ${data.recursive_metis}
      test:
      - _target_: graphwm.data.PolymerDataset
        split: ${oc.env:PROJECT_ROOT}/splits/chain/val.txt
        directory: ${data.dir}
        dilation: ${model.dilation}
        seq_len: ${model.seq_len}
        grouping: ${model.cg_level}
        traj_len: ${data.traj_len}
        recursive_metis: ${data.recursive_metis}
    num_workers:
      train: 16
      val: 16
      test: 16
    batch_size:
      train: ${data.batch_size}
      val: ${data.batch_size}
      test: ${data.batch_size}
model:
  _target_: graphwm.model.GNS
  name: gns
  dimension: ${data.dimension}
  use_atom_mass: false
  use_weights: false
  seq_len: 30
  dilation: 1
  num_ptypes: 5
  num_btypes: 0
  cg_level: 100
  radius: 200
  min_std: 0.1
  type_emb_size: 32
  dynamics_gn_hparams:
    latent_dim: 128
    units: 128
    layers: 2
    mp_steps: 7
  embedding_gn_hparams:
    latent_dim: 64
    units: 64
    layers: 2
    mp_steps: 7
  property_net_hparams:
    units: 256
    layers: 2
    out_dim: 1
  noise_method: multi_scale
  noise_target: pos
  noise_begin: 0.1
  noise_end: 0.01
  noise_level: 10
logging:
  val_check_interval: 600
  progress_bar_refresh_rate: 10
  wandb:
    name: ${expname}
    group: ${expname}
    save_dir: ${workdir}
    project: mlcgmd
    entity: null
    log_model: true
    mode: online
  wandb_watch:
    log: all
    log_freq: 1000
  lr_monitor:
    logging_interval: step
    log_momentum: false
optim:
  optimizer:
    _target_: torch.optim.Adam
    lr: 0.0001
    betas:
    - 0.9
    - 0.999
    eps: 1.0e-08
    weight_decay: 0
  use_lr_scheduler: true
  scheduler_interval: step
  lr_scheduler:
    _target_: graphwm.common.CustomScheduleLR
    min_lr: 2.0e-06
    decay_steps: 2000000.0
    decay_rate: 0.1
    last_epoch: -1
    verbose: false
train:
  deterministic: false
  random_seed: 42
  pl_trainer:
    fast_dev_run: false
    gpus: 1
    precision: 32
    max_steps: 500000.0
    accumulate_grad_batches: 1
    num_sanity_val_steps: 2
    gradient_clip_val: 20.0
    limit_train_batches: 1.0
    limit_val_batches: 2000.0
    limit_test_batches: 1.0
    accelerator: ddp
  monitor_metric: val_acc_loss
  monitor_metric_mode: min
  model_checkpoints:
    save_top_k: 1
    save_last: true
    verbose: false
expname: ${data.name}_${model.name}
workdir: ${oc.env:MODEL_DIR}/${expname}
core:
  version: 0.0.1
  tags:
  - mytag
